<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff View Orders</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/navbar.css">
    <link rel="stylesheet" href="/css/view_orders.css">
</head>
<body>
<!-- Include navbar fragment -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<main class="main-content">
    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">Staff Order Management</h1>
            <p class="page-subtitle">Monitor and manage all customer orders</p>
        </div>

        <!-- Order Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üì¶</div>
                <div class="stat-info">
                    <h3>Total Orders</h3>
                    <p class="stat-number" th:text="${totalOrders ?: '0'}">0</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-info">
                    <h3>Pending Orders</h3>
                    <p class="stat-number pending" th:text="${pendingOrders ?: '0'}">0</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <h3>Delivered</h3>
                    <p class="stat-number delivered" th:text="${deliveredOrders ?: '0'}">0</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-info">
                    <h3>Total Revenue</h3>
                    <p class="stat-number" th:text="${totalRevenue ?: '$0.00'}">$0.00</p>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="filters-section">
            <div class="search-box">
                <input type="text" id="orderSearch" placeholder="Search orders by ID, customer, or product..." class="form-input">
                <button class="btn btn-primary search-btn">üîç</button>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-status="all">All Orders</button>
                <button class="filter-btn" data-status="pending">Pending</button>
                <button class="filter-btn" data-status="processing">Processing</button>
                <button class="filter-btn" data-status="shipped">Shipped</button>
                <button class="filter-btn" data-status="delivered">Delivered</button>
            </div>
        </div>

        <!-- Orders Table -->
        <div class="table-section">
            <div class="table-container">
                <table class="orders-table" id="ordersTable">
                    <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer</th>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Total Price</th>
                        <th>Status</th>
                        <th>Order Date</th>
                        <th>Expected Delivery</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Example row with Thymeleaf template -->
                    <tr th:each="order : ${orders}" th:class="'order-row ' + ${order.status}">
                        <td class="order-id">
                            <span class="id-badge" th:text="'#' + ${order.id}">#001</span>
                        </td>
                        <td class="customer-info">
                            <div class="customer-name" th:text="${order.customerName}">John Doe</div>
                            <div class="customer-email" th:text="${order.customerEmail}">john@example.com</div>
                        </td>
                        <td class="product-info">
                            <div class="product-name" th:text="${order.productName}">Gaming PC Build</div>
                            <div class="product-sku" th:text="'SKU: ' + ${order.productSku}">SKU: PC-001</div>
                        </td>
                        <td class="quantity" th:text="${order.quantity}">1</td>
                        <td class="price" th:text="'$' + ${order.totalPrice}">$1,299.99</td>
                        <td class="status">
                                    <span class="status-badge" th:class="'status-' + ${order.status}" th:text="${order.status}">
                                        pending
                                    </span>
                        </td>
                        <td class="order-date" th:text="${#temporals.format(order.orderDate, 'MMM dd, yyyy')}">
                            Aug 15, 2025
                        </td>
                        <td class="delivery-date" th:text="${#temporals.format(order.expectedDelivery, 'MMM dd, yyyy')}">
                            Aug 20, 2025
                        </td>
                        <td class="actions">
                            <div class="action-buttons">
                                <button class="btn-action view" th:onclick="'viewOrder(' + ${order.id} + ')'">
                                    üëÅÔ∏è
                                </button>
                                <button class="btn-action edit" th:onclick="'editOrder(' + ${order.id} + ')'">
                                    ‚úèÔ∏è
                                </button>
                                <select class="status-select" th:data-order-id="${order.id}">
                                    <option value="pending" th:selected="${order.status == 'pending'}">Pending</option>
                                    <option value="processing" th:selected="${order.status == 'processing'}">Processing</option>
                                    <option value="shipped" th:selected="${order.status == 'shipped'}">Shipped</option>
                                    <option value="delivered" th:selected="${order.status == 'delivered'}">Delivered</option>
                                </select>
                            </div>
                        </td>
                    </tr>

                    <!-- Sample static rows for demonstration -->
                    <tr class="order-row pending">
                        <td class="order-id"><span class="id-badge">#001</span></td>
                        <td class="customer-info">
                            <div class="customer-name">John Doe</div>
                            <div class="customer-email">john@example.com</div>
                        </td>
                        <td class="product-info">
                            <div class="product-name">Gaming PC Build</div>
                            <div class="product-sku">SKU: PC-001</div>
                        </td>
                        <td class="quantity">1</td>
                        <td class="price">$1,299.99</td>
                        <td class="status"><span class="status-badge status-pending">pending</span></td>
                        <td class="order-date">Aug 15, 2025</td>
                        <td class="delivery-date">Aug 20, 2025</td>
                        <td class="actions">
                            <div class="action-buttons">
                                <button class="btn-action view">üëÅÔ∏è</button>
                                <button class="btn-action edit">‚úèÔ∏è</button>
                                <select class="status-select">
                                    <option value="pending" selected>Pending</option>
                                    <option value="processing">Processing</option>
                                    <option value="shipped">Shipped</option>
                                    <option value="delivered">Delivered</option>
                                </select>
                            </div>
                        </td>
                    </tr>

                    <tr class="order-row delivered">
                        <td class="order-id"><span class="id-badge">#002</span></td>
                        <td class="customer-info">
                            <div class="customer-name">Jane Smith</div>
                            <div class="customer-email">jane@example.com</div>
                        </td>
                        <td class="product-info">
                            <div class="product-name">RTX 4090 Graphics Card</div>
                            <div class="product-sku">SKU: GPU-4090</div>
                        </td>
                        <td class="quantity">1</td>
                        <td class="price">$1,599.99</td>
                        <td class="status"><span class="status-badge status-delivered">delivered</span></td>
                        <td class="order-date">Aug 10, 2025</td>
                        <td class="delivery-date">Aug 14, 2025</td>
                        <td class="actions">
                            <div class="action-buttons">
                                <button class="btn-action view">üëÅÔ∏è</button>
                                <button class="btn-action edit">‚úèÔ∏è</button>
                                <select class="status-select">
                                    <option value="pending">Pending</option>
                                    <option value="processing">Processing</option>
                                    <option value="shipped">Shipped</option>
                                    <option value="delivered" selected>Delivered</option>
                                </select>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <!-- Empty state -->
                <div class="empty-state" th:if="${#lists.isEmpty(orders)}" style="display: none;">
                    <div class="empty-icon">üì¶</div>
                    <h3>No Orders Found</h3>
                    <p>There are currently no orders to display.</p>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    // Basic JavaScript for filtering and interactions
    document.addEventListener('DOMContentLoaded', function() {
        // Filter buttons
        const filterBtns = document.querySelectorAll('.filter-btn');
        const orderRows = document.querySelectorAll('.order-row');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const status = this.dataset.status;

                // Update active button
                filterBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Filter rows
                orderRows.forEach(row => {
                    if (status === 'all' || row.classList.contains(status)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        });

        // Search functionality
        const searchInput = document.getElementById('orderSearch');
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();

            orderRows.forEach(row => {
                const text = row.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // Status change handlers
        const statusSelects = document.querySelectorAll('.status-select');
        statusSelects.forEach(select => {
            select.addEventListener('change', function() {
                const orderId = this.dataset.orderId;
                const newStatus = this.value;
                console.log(`Updating order ${orderId} to status: ${newStatus}`);
                // Add AJAX call to update status here
            });
        });
    });

    function viewOrder(orderId) {
        console.log('View order:', orderId);
        // Implement view order functionality
    }

    function editOrder(orderId) {
        console.log('Edit order:', orderId);
        // Implement edit order functionality
    }
</script>
</body>
</html>